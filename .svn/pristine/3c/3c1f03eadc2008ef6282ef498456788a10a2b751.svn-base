
@{
    ViewBag.Title = "ViewAddOnPackageDetails";
    Layout = "~/Views/Shared/_CommonLayout.cshtml";
}

<style type="text/css">
    tr.highlight td.jsgrid-cell {
        background-color: lightgoldenrodyellow;
    }

    .jsgrid-grid-header,
    .jsgrid-grid-body {
        overflow: auto;
    }
</style>
<script>
    window.location.hash = "no-back-button";
    window.location.hash = "Again-No-back-button";
    window.onhashchange = function () { window.location.hash = "no-back-button"; }
</script>
<script type="text/javascript">
    var arrRegData = [];
    $(document).keydown(function (event) {
        event = (event || window.event);
        if ((event.keyCode == 49) && (event.shiftKey === true)) {
             window.location.href = '@Url.Action("ViewBlockPackage", "BlockPackage")';
        }
        else if ((event.keyCode == 50) && (event.shiftKey === true)) {
             window.location.href = '@Url.Action("ViewMultipleBlockPackage", "BlockPackage")';
        }
        else if ((event.keyCode == 51) && (event.shiftKey === true)) {
           window.location.href = '@Url.Action("PreAuthorizationDetails", "PreAuthorization")';
        }
        else if ((event.keyCode == 52) && (event.shiftKey === true)) {
            window.location.href = '@Url.Action("ViewExtensionOfStay", "ExtensionOfStay")';
        }
    });
    $(document).ready(function () {
        $('#path').html('Previous Add On Package Details');
        fillgrid();
        $('#ddlRows').change(function () {
            if ($("option:selected", $("#ddlRows")).val() == '1') {
                $("#jsGrid").jsGrid({ pageSize: 10});
            }
           else if ($("option:selected", $("#ddlRows")).val() == '2') {
                $("#jsGrid").jsGrid({ pageSize: 20 });
            }
           else if ($("option:selected", $("#ddlRows")).val() == '3') {
                $("#jsGrid").jsGrid({ pageSize: 50 });
            }
           else if ($("option:selected", $("#ddlRows")).val() == '4') {
                $("#jsGrid").jsGrid({ pageSize: 100 });
            }
          else if ($("option:selected", $("#ddlRows")).val() == '5') {
                $("#jsGrid").jsGrid({ pageSize: 200 });
            }
          else if ($("option:selected", $("#ddlRows")).val() == '6') {
                $("#jsGrid").jsGrid({ pageSize: 500 });
            }
        });

    });
    function fillgrid() {
        $('#jsGrid').jsGrid({
            width: "100%",
            sorting: true,
            paging: true,
            autoload: true,
            pageSize: 10,
            pagerFormat: "Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount} &nbsp;&nbsp; Total rows: {itemCount}",
            pageButtonCount: 10,
            rowClick: function (args) {
                //console.log(args)
                var $row = this.rowByItem(args.item),
                    selectedRow = $("#jsGrid").find('table tr.highlight');
                if (selectedRow.length) {
                    selectedRow.toggleClass('highlight');
                };
                $row.toggleClass("highlight");
            },
            controller: {
                loadData: function (filter) {
                    var d = $.Deferred();
                    var RegParams = {
                        Action: 'B',
                        InvoiceNo: '@ViewBag.InvNo'
                    };
                    return $.ajax({
                        url: ServiceURL + "/api/Registration/GetPreviousAddOnPackageDetailsByInvoiceNo",
                        type: "GET",
                        data: RegParams,
                        dataType: "json",
                        contentType: "application/json; charset=utf-8",
                        error: function (error) {
                            console.log(error.statusText);
                        },
                    }).done(function (result) {
                        //console.log(result);
                        if (result.length > 0) {
                            $('#divRowCount').show();
                            d.resolve($.map(result, function (item, itemIndex) {
                                return $.extend(item, { "Index": itemIndex + 1 });
                            }
                            ));
                        }
                        else {
                            $('#divRowCount').hide();
                        }
                    });
                    return d.promise();
                }

            },

            fields: [
                { name: "Index", width: 50, type: "number", title: "#Sl", align: "center", filtering: false },
                { name: "procedureName", type: "text", title: "Procedure", align: "center" },
                { name: "procedureCode", type: "text", title: "Procedure Code", align: "center", visible: false },
                { name: "categoryName", type: "text", title: "Category", align: "center" },
                { name: "categoryCode", type: "text", title: "Category Code", align: "center", visible: false },
                { name: "packageName", type: "text", title: "Package Name", align: "center" },
                { name: "packageCode", type: "text", title: "Package Code", align: "center", visible: false },
                { name: "blockingDate", type: "text", title: "Blocking Date", align: "center" },
                { name: "blockingAmount", type: "text", title: "Blocking Amount(Rs.)", align: "center" }

            ]
        });
    }
   </script>
<!-- Dashboard Body content part starts -->
<div class="container-fluid">
    <div class="row">
        <div class="col-12 pb-3">
            <div class="card">
                <div class="card-body">
                    <div id="divTranId" hidden></div>
                    <div class="table table-striped table-bordered" id="jsGrid">
                    </div>                   
                </div>
            </div>
        </div>
    </div>
</div>
