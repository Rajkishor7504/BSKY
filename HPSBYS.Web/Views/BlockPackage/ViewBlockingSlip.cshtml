@{
    ViewBag.Title = "ViewBlockingSlip";
}
@using System.Configuration
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Patient Slip</title>
    <script src="~/js/jquery.min.js" type="text/javascript"></script>
    <script src="~/js/popper.min.js" type="text/javascript"></script>
    <!-- <link rel="stylesheet" href="~/css/style.css" /> -->
    <link rel="stylesheet" href="~/css/print.css" />
    <link rel="stylesheet" href="~/css/landscape.css" />

</head>

<body class="print_bg">

    <div class="tm_container">
        <div class="tm_invoice_btns tm_hide_print row">
            <div class="col-md-1 text-align-right">
                <a href="javascript:window.print()" class="tm_invoice_btn tm_color1" id="printbutton">
                    <span class="tm_btn_icon">
                        <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M384 368h24a40.12 40.12 0 0040-40V168a40.12 40.12 0 00-40-40H104a40.12 40.12 0 00-40 40v160a40.12 40.12 0 0040 40h24" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32" /><rect x="128" y="240" width="256" height="208" rx="24.32" ry="24.32" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32" /><path d="M384 128v-24a40.12 40.12 0 00-40-40H168a40.12 40.12 0 00-40 40v24" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32" /><circle cx="392" cy="184" r="24" fill='currentColor' /></svg>
                    </span>
                    <span class="tm_btn_text">Print</span>
                </a>
            </div>
        </div>
        <div class="tm_invoice tm_style1 tm_type1">
            <div class="tm_invoice_in">
                <div class="tm_invoice_head tm_top_head tm_align_center">
                    <div class="tm_invoice_left">
                        <div class="tm_logo"><img src="~/imgs/logo.png"></div>
                    </div>
                </div>

                <h3 style="text-align:center;text-align: center;margin: 0; font-size: 26px;">  Patient Slip </h3>

                <div class="tm_invoice_wrap border_none">

                    @*@if (@Model.blockpackageslip.Count > 0)
                        {*@

                    <div style=" text-align: center; margin-bottom: 10px;"> <b>Blocking Transaction - </b><label id="lblblockingtransction"></label> </div>

                    <table class="table table_none dischrge-sec">
                        <thead>
                            <tr>
                                <td width="20%" class="font-weight-normal pl-0"> <b> Beneficiary Name </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3">: </span><label id="lblbenificiaryname"></label>  </td>
                                <td class="font-weight-normal pl-0"> <b> Beneficiary Id  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblbenificiaryid"></label>   </td>
                            </tr>
                            <tr>
                                <td class="font-weight-normal pl-0"> <b> URN  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblURN"></label>    </td>
                                <td class="font-weight-normal pl-0"> <b> Hospital Name  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span>  <label id="lblHospitalname"></label>  </td>
                            </tr>
                            <tr>
                                <td class="font-weight-normal pl-0"> <b> Hospital Id  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblHospitalID"></label>    </td>
                                <td class="font-weight-normal pl-0"> <b> Authority Id  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblAuthorityID"></label>   </td>
                            </tr>
                            <tr>

                                <td class="font-weight-normal pl-0"> <b> Verification Mode </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblVerificationMode"></label> </td>
                                <td class="font-weight-normal pl-0"> <b> Verifier Name  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblVerifierName"></label>  </td>
                            </tr>
                            <tr>
                                <td class="font-weight-normal pl-0"> <b> Verifier Relation  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblVerifierRelation"></label>   </td>
                                <td class="font-weight-normal pl-0"> <b> Family Head  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblFamilyHead"></label>  </td>
                            </tr>
                            <tr>
                                <td class="font-weight-normal pl-0"> <b> Family Relation  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblFamilyRelation"></label>    </td>
                                <td width="20%" class="font-weight-normal pl-0"> <b> Invoice No </b>  </td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblInvoiceNo"></label>  </td>

                            </tr>

                            <tr>

                                <td width="20%" class="font-weight-normal pl-0"> <b> Case No </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3">: </span><label id="lblCaseNo"></label> </td>
                                @*<td class="font-weight-normal pl-0"> <b> Ward Name</b></td>
        <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblWardName"></label>   </td>*@
                                <td class="font-weight-normal pl-0"> <b> Date & Time  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lbldatetime"></label>   </td>

                            </tr>
                            @*<tr>
                                    <td class="font-weight-normal pl-0"> <b> Implant  </b></td>
                                    <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblimplant"></label> </td>
                                    <td class="font-weight-normal pl-0"> <b> Highend-Drug  </b></td>
                                    <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lblhighenddrug"></label>   </td>
                                </tr>*@
                            @*<tr>

                                <td class="font-weight-normal pl-0"> <b> Date & Time  </b></td>
                                <td class="pl-0"> <span class="dot_cl mr-3"> : </span><label id="lbldatetime"></label>   </td>

                            </tr>*@


                        </thead>
                    </table>


                    <div class="w-40 pl-0"> <b> BSKY  </b></div>
                    <div class="w-60 pl-0" align="right"> <b> Actual date of admission - </b><label id="lbldateofadmission"></label>   </div>
                    <table id="tblpackagedetails" class="table dischrge-sec top-gap bottom-gap fl" border="1">



                        @*<thead>
                                <tr>
                                    <td class="font-weight-normal" align="left" style="background-color:#f2fff7!important;"> <b> Package Code  </b></td>
                                    <td class="font-weight-normal" align="left" style="background-color:#f2fff7!important;"> <b> Selected Treatment Name  </b></td>
                                    <td class="font-weight-normal" align="left" style="background-color:#f2fff7!important;"> <b> Selected Package Name  </b></td>
                                    <td class="font-weight-normal" align="left" style="background-color:#f2fff7!important;"> <b> Days  </b></td>
                                    <td class="font-weight-normal" align="right" style="background-color:#f2fff7!important;">  <b> Amount(INR)  </b></td>
                                </tr>
                            </thead>*@

                        @*<tbody>
                                <tr>
                                    <td> MG027A </td>
                                    <td>General Medicine</td>
                                    <td> Bronchiectasis </td>
                                    <td> 2 </td>
                                    <td align="right"> 26,000 </td>
                                </tr>



                                <tr>
                                    <td rowspan="3">SG050E</td>
                                    <td>General Surgery</td>
                                    <td> Obturator - Lap. </td>
                                    <td> 0 </td>
                                    <td align="right"> 31,258 </td>

                                </tr>

                                <tr>
                                    <td colspan="2" style="background-color:#f2fff7!important;"> <b> Implant Details </b> </td>



                                    <td colspan="2" style="background-color:#f2fff7!important;"> <b> HighEndDrugs Details </b> </td>
                                </tr>

                                <tr>

                                    <td colspan="2" class="p-0">
                                        <table class="table dischrge-sec border_none" border="0">
                                            <tr>
                                                <td> <b> Name </b></td>
                                                <td> <b> Unit </b> </td>
                                                <td align="right"> <b> Price </b> </td>
                                                <td align="right"> <b> Total Price </b> </td>
                                            </tr>


                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                            </tr>


                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                            </tr>


                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                            </tr>


                                            <tr>
                                                <td> &nbsp; </td>
                                                <td> &nbsp; </td>
                                                <td align="right"> <b> Total </b> </td>
                                                <td align="right"> <b> 1,50,000.00 </b> </td>

                                            </tr>

                                        </table>
                                    </td>



                                    <td colspan="2" class="p-0">
                                        <table class="table dischrge-sec" border="0">
                                            <tr>
                                                <td> <b> Name </b> </td>
                                                <td> <b> Unit  </b> </td>
                                                <td align="right"> <b> Price </b> </td>
                                                <td align="right">  <b>Total Price </b> </td>
                                                <td> <b> Pre-Auth </b>  </td>
                                            </tr>




                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td> Yes </td>
                                            </tr>



                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td> Yes </td>
                                            </tr>





                                            <tr>
                                                <td> IV immunoglobins </td>
                                                <td> 1 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td align="right"> 250000.00 </td>
                                                <td> Yes </td>
                                            </tr>


                                            <tr>
                                                <td> &nbsp; </td>
                                                <td> &nbsp; </td>
                                                <td align="right"> <b> Total </b> </td>
                                                <td align="right"> <b> 1,50,000.00 </b> </td>

                                            </tr>


                                        </table>
                                    </td>


                                </tr>
                            </tbody>*@



                    </table>




                    <table class="table table_none">
                        <tr>
                            <td class="pl-0"> <div> <b> Balance Available :   </b><label id="lblbalanceavailable"></label>  </div> </td>
                            <td align="right"> <div> <b> Total Amount Blocked : </b><label id="lblamountblocked"></label>  </div> </td>
                            <td align="right"> <div> <b> </b> </div> </td>
                        </tr>
                        <tr>
                            <td> &nbsp; </td>
                            <td align="right">  <div> <b> Insufficent Amount : </b><label id="lblinsufficentamount"></label> </div> </td>
                            <td align="right">  <div> <b>  </b> </div> </td>
                        </tr>
                        <tr>
                            <td colspan="3"> <div class="inf_brd"> </div> </td>
                        </tr>
                        <tr>
                            <td> &nbsp; </td>
                            <td align="right">  <div> <b>  Total Amount : </b><label id="lbltotalamount"></label> </div> </td>
                            <td align="right">  <div> <b>  </b> </div> </td>
                        </tr>
                        <tr>
                            <td colspan="3"> <div class="inf_brd"> </div> </td>
                        </tr>
                    </table>
                    <div class="auth-bg pl-0"> <b> Authenticated by : </b> <span>  </span><label id="lblAuthenticatedby"></label> </div>


                </div>
            </div>
        </div>
    </div>
    <script>
        $("#printbutton").click(function () {
            $("#printbutton").css("display", "none");
        });
         ServiceURL = "@ConfigurationManager.AppSettings["ServiceURL"]";
        console.log("url", ServiceURL);
        $(document).ready(function () {
        if (localStorage.getItem('InsertedData') != null) {
            var PackageInfo = JSON.parse(localStorage.getItem('InsertedData'));
            console.log('PatientSlip Data', PackageInfo);
        }
        var modeldata = JSON.stringify({
            INVOICE: PackageInfo.INVOICE,
            URN: PackageInfo.URN,
            TRANSACTIONID: PackageInfo.TRANSACTIONID
        });
        $.ajax({
            url: ServiceURL + "/api/BlockPackage/ViewBlockingSlip",
            type: "POST",
            data: modeldata,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (response) {
                //debugger;
                console.log(response);
                $('#lblblockingtransction').text(response.blockpackageslip[0].BlockingTransaction);
                $('#lblbenificiaryname').text(response.blockpackageslip[0].MEMBERNAME);
                $('#lblbenificiaryid').text(response.blockpackageslip[0].MEMBERID);
                $('#lblURN').text(response.blockpackageslip[0].URN);
                $('#lblHospitalname').text(response.blockpackageslip[0].HOSPITALNAME);
                $('#lblHospitalID').text(response.blockpackageslip[0].HOSPITALCODE);
                $('#lblAuthorityID').text(response.blockpackageslip[0].HOSPITALAUTHORITYCODE);
                $('#lblVerificationMode').text(response.blockpackageslip[0].VERIFICATIONMODE);
                $('#lblVerifierName').text(response.blockpackageslip[0].VERIFIEDMEMBERNAME);
                $('#lblVerifierRelation').text(response.blockpackageslip[0].VERIFIERFAMILYRELATION);
                $('#lblFamilyHead').text(response.blockpackageslip[0].HEADMEMBERNAME);
                $('#lblFamilyRelation').text(response.blockpackageslip[0].FAMILYRELATION);
                $('#lblInvoiceNo').text(response.blockpackageslip[0].INVOICE);
                $('#lblCaseNo').text(response.blockpackageslip[0].CASENO);
               // $('#lblWardName').text(response.blockpackageslip[0].WARDNAME);
                $('#lblimplant').text(response.blockpackageslip[0].IMPLANTDATA);
                $('#lblhighenddrug').text(response.blockpackageslip[0].HED);
                $('#lbldatetime').text(response.blockpackageslip[0].DATETIME);
                $('#lbldateofadmission').text(response.blockpackageslip[0].ADMISSIONDATE);
                $('#lblbalanceavailable').text(response.blockpackageslip[0].AVAILABLEBALNCE);
                $('#lblamountblocked').text(response.blockpackageslip[0].TOTALBLOCKED);
                $('#lblinsufficentamount').text(response.blockpackageslip[0].INSUFFICIENTAMOUNT);
                $('#lbltotalamount').text(response.blockpackageslip[0].TOTALAMOUNT);
                $('#lblAuthenticatedby').text(response.blockpackageslip[0].HOSPITALNAME);
                for (var i = 0; i < response.packagedetailsdata.length; i++) {
                    var htm = '';
                    if ($('#tblpackagedetails tr').length == 0) {
                        htm += '<thead><tr><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Sl#</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Package Code</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Treatment Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Package Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Ward Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Blocked Date</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Days</th><th class="font-weight-normal" align="right" style="background-color:#f2fff7!important;">Ward Cost(INR)</th><th class="font-weight-normal" align="right" style="background-color:#f2fff7!important;">Package Cost(INR)</th></tr></thead>'
                        // htm += '<tr> <td class="font-weight-normal" rowspan="9" align="left"> 1 </td><td class="font-weight-normal" rowspan="9" align="left">' + response.blockpackageslip[i].PROCEDURECODE + '</td>'
                        htm += '<tr> <td class="font-weight-normal" align="left"> 1 </td><td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PROCEDURECODE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PACKAGEHEADERNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PROCEDURENAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].WARDNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].BLOCKDATE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].NOOFDAYS + '</td>'
                        htm += '<td class="font-weight-normal" align="right">' + response.packagedetailsdata[i].PACKAGECOST + '</td>'
                        //htm += '<td class="font-weight-normal" colspan="2" align="right">' + response.blockpackageslip[i].AMOUNTBLOCKED + '</td></tr>'
                        htm += '<td class="font-weight-normal" align="right">' + response.packagedetailsdata[i].TOTALPACKAGECOST + '</td></tr>'
                        //  htm += '<tr><td  align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td><td  align="center" style="background-color:#f2fff7!important;"> <b> Highend Drugs </b></td></tr>'


                        var count = 0;
                        var slno = 1;
                        for (var j = 0; j < response.implantdata.length; j++) {
                            if (response.implantdata.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.implantdata[j].TXNPACKAGEDETAILID) {
                                if (count == 0) {
                                    //htm += '<tr><td colspan="5" align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td>'
                                    //htm += '<tr><td align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td>'
                                    htm += '<td colspan="9" align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td></tr>'
                                    htm += '<tr><td class="font-weight-normal" align="left"><b>Sl#</b></td><td class="font-weight-normal" align="left"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" class="font-weight-normal"><b>Price</b></td><td colspan="5" class="font-weight-normal" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }
                                htm += '<tr><td align = "left">' + slno + '</td ><td align = "left">' + response.implantdata[j].IMPLANTNAME + '</td >'
                                htm += '<td align = "left">' + response.implantdata[j].UNIT + '</td>'
                                htm += '<td align = "right" >' + response.implantdata[j].UNITCYCLEPRICE + '</td >'
                                htm += '<td colspan="5" align = "right" >' + response.implantdata[j].AMOUNT + '</td ></tr >'
                                //  htm += '<td align = "right" >' + response.implantdata[j].AMOUNT + '</td ></tr >'

                            }
                            slno++;
                        }
                        var count = 0;
                        var slno = 1;
                        for (var k = 0; k < response.highendrug.length; k++) {
                            if (response.highendrug.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.highendrug[k].TXNPACKAGEDETAILID) {
                                if (count == 0) {
                                    /* htm += '<tr><td align="center" colspan="5" style="background-color:#f2fff7!important;"> <b> Highend Drugs </b></td>'*/
                                    htm += '<tr><td align="center" colspan="9" style="background-color:#f2fff7!important;"> <b> Highend Drugs </b></td>'
                                    htm += '<tr><td class="font-weight-normal" align="left"><b>Sl#</b></td><td class="font-weight-normal" align="left"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Pre-Auth</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" colspan="3" class="font-weight-normal"><b>Price</b></td><td class="font-weight-normal" colspan="2" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }
                                htm += '<tr><td align = "left">' + slno + '</td ><td align = "left">' + response.highendrug[k].HEDNAME + '</td >'
                                htm += '<td align = "left">' + response.highendrug[k].PREAUTH + '</td>'
                                htm += '<td align = "left" >' + response.highendrug[k].HEDUNIT + '</td >'
                                htm += '<td colspan="3" align = "right" >' + response.highendrug[k].HEDPRICEPERUNIT + '</td >'
                                htm += '<td colspan="2" align = "right" >' + response.highendrug[k].HEDPRICE + '</td ></tr > '

                            }
                            slno++;
                        }
                        htm += '<tr><td align="right" colspan="9"> <b> Blocked Amount : </b>   ' + " " + ' <b style="color:red">' + response.packagedetailsdata[i].AMOUNTBLOCKED + '</b>  </td></tr>'
                    }
                    else if ($('#tblpackagedetails tr').length > 0 && response.highendrug.length > 0 || response.highendrug.length > 0) {
                        var slno = i + 1;
                        htm += '<thead><tr><th class="font-weight-normal" style="background-color:#f2fff7!important;">Sl#</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Package Code</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Treatment Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Package Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Ward Name</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Blocked Date</th><th class="font-weight-normal" align="left" style="background-color:#f2fff7!important;">Days</th><th class="font-weight-normal" align="right" style="background-color:#f2fff7!important;">Ward Cost(INR) </th><th class="font-weight-normal" align="right" style="background-color:#f2fff7!important;">Package Cost(INR) </th></tr></thead>'
                        htm += '<tr> <td class="font-weight-normal" align="left">' + slno + '</td><td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PROCEDURECODE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PACKAGEHEADERNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PROCEDURENAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].WARDNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].BLOCKDATE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].NOOFDAYS + '</td>'
                        htm += '<td class="font-weight-normal" align="right">' + response.packagedetailsdata[i].PACKAGECOST + '</td>'
                        htm += '<td class="font-weight-normal" colspan="2" align="right">' + response.packagedetailsdata[i].TOTALPACKAGECOST + '</td></tr>'
                        var count = 0;
                        var sl2 = 1;
                        for (var j = 0; j < response.implantdata.length; j++) {
                            if (response.implantdata.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.implantdata[j].TXNPACKAGEDETAILID) {
                                if (count == 0) {
                                    /* htm += '<tr><td colspan="6" align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td>'*/
                                    htm += '<tr><td colspan="9" align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td>'
                                    htm += '<tr><td class="font-weight-normal" align="left"><b>Sl#</b></td><td class="font-weight-normal" align="left" colspan="4"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" class="font-weight-normal"><b>Price</b></td><td class="font-weight-normal" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }
                                htm += '<tr><td colspan="2" align = "left">' + sl2 + '</td ><td colspan="3" align = "left">' + response.implantdata[j].IMPLANTNAME + '</td >'
                                htm += '<td align = "left">' + response.implantdata[j].UNIT + '</td>'
                                htm += '<td align = "right" >' + response.implantdata[j].UNITCYCLEPRICE + '</td >'
                                htm += '<td align = "right" >' + response.implantdata[j].AMOUNT + '</td ></tr >'
                                sl2++;

                            }

                        }
                        var count = 0;
                        var sl1 = 1;
                        for (var k = 0; k < response.highendrug.length; k++) {

                            if (response.highendrug.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.highendrug[k].TXNPACKAGEDETAILID) {

                                if (count == 0) {
                                    htm += '<tr><td colspan="9" align="center" style="background-color:#f2fff7!important;"> <b> Highend Drugs </b></td>'
                                    htm += '<tr><td class="font-weight-normal" align="left"><b>Sl#</b></td><td class="font-weight-normal" align="left"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Pre-Auth</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" colspan="3" class="font-weight-normal"><b>Price</b></td><td class="font-weight-normal" colspan="2" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }
                                htm += '<tr><td align = "left">' + sl1 + '</td ><td align = "left">' + response.highendrug[k].HEDNAME + '</td >'
                                htm += '<td align = "left">' + response.highendrug[k].PREAUTH + '</td>'
                                htm += '<td align = "left" >' + response.highendrug[k].HEDUNIT + '</td >'
                                htm += '<td colspan="3" align = "right" >' + response.highendrug[k].HEDPRICEPERUNIT + '</td >'
                                htm += '<td colspan="2" align = "right" >' + response.highendrug[k].HEDPRICE + '</td ></tr > '
                                sl1++;
                            }

                        }
                        htm += '<tr><td align="right" colspan="9"> <b>Blocked Amount : </b>   ' + " " + ' <b style="color:red">' + response.packagedetailsdata[i].AMOUNTBLOCKED + '</b>  </td></tr>'


                    }

                    else {
                        var pkno = i + 1;
                        htm += '<tr> <td align="left">' + pkno + '</td><td>' + response.packagedetailsdata[i].PROCEDURECODE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PACKAGEHEADERNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].PROCEDURENAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].WARDNAME + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].BLOCKDATE + '</td>'
                        htm += '<td class="font-weight-normal" align="left">' + response.packagedetailsdata[i].NOOFDAYS + '</td>'
                        htm += '<td class="font-weight-normal" align="right">' + response.packagedetailsdata[i].PACKAGECOST + '</td>'
                        htm += '<td class="font-weight-normal" align="right">' + response.packagedetailsdata[i].TOTALPACKAGECOST + '</td></tr>'
                        var count = 0;
                        var h2no = 1;
                        for (var j = 0; j < response.implantdata.length; j++) {
                            if (response.implantdata.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.implantdata[j].TXNPACKAGEDETAILID) {
                                if (count == 0) {
                                    htm += '<tr><td colspan="9" align="center" style="background-color:#f2fff7!important;"> <b> Implant </b></td>'
                                    htm += '<tr><td class="font-weight-normal" align="left"><b>Sl#</b></td><td class="font-weight-normal" align="left" colspan="5"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" class="font-weight-normal"><b>Price</b></td><td class="font-weight-normal" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }



                                htm += '<tr><td align = "left">' + h2no + '</td ><td colspan="3" align = "left">' + response.implantdata[j].IMPLANTNAME + '</td >'
                                htm += '<td align = "left">' + response.implantdata[j].UNIT + '</td>'
                                htm += '<td align = "right" >' + response.implantdata[j].UNITCYCLEPRICE + '</td >'
                                htm += '<td align = "right" >' + response.implantdata[j].AMOUNT + '</td ></tr >'
                                h2no++;
                            }

                        }
                        var count = 0;
                        var h1no = 1;
                        for (var k = 0; k < response.highendrug.length; k++) {
                            if (response.highendrug.length > 0 && response.packagedetailsdata[i].TXNPACKAGEDETAILID == response.highendrug[k].TXNPACKAGEDETAILID) {
                                if (count == 0) {
                                    htm += '<tr><td colspan="9" align="center" style="background-color:#f2fff7!important;"> <b> Highend Drugs </b></td>'
                                    htm += '<tr<td class="font-weight-normal" align="left"><b>Sl#</b></td>><td class="font-weight-normal" align="left"><b>Name</b></td><td class="font-weight-normal" align="left"><b>Pre-Auth</b></td><td class="font-weight-normal" align="left"><b>Unit</b></td><td align="right" colspan="3" class="font-weight-normal"><b>Price</b></td><td class="font-weight-normal" colspan="2" align="right"><b>Total Price</b></td></tr>'
                                    count = 1;
                                }

                                htm += '<tr><td align = "left">' + h1no + '</td ><td align = "left">' + response.highendrug[k].HEDNAME + '</td >'
                                htm += '<td align = "left">' + response.highendrug[k].PREAUTH + '</td>'
                                htm += '<td align = "left" >' + response.highendrug[k].HEDUNIT + '</td >'
                                htm += '<td colspan="3" align = "right" >' + response.highendrug[k].HEDPRICEPERUNIT + '</td >'
                                htm += '<td colspan="2" align = "right" >' + response.highendrug[k].HEDPRICE + '</td ></tr > '
                                h1no++;
                            }

                        }
                        htm += '<tr><td align="right" colspan="9"> <b> Blocked Amount : </b>   ' + " " + ' <b style="color:red">' + response.packagedetailsdata[i].AMOUNTBLOCKED + '</b>  </td></tr>'


                    }
                    $("#tblpackagedetails").append(htm);

                }

            },
            failure: function (response) {
                alert(response.d);
            },
            error: function (response) {
                alert(response.d);
            }
        });
    });
    </script>
</body>
</html>
