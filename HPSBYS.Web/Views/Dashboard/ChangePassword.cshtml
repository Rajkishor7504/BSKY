@model HPSBYS.Data.Model.Login
@{
/**/
ViewBag.Title = "ChangePassword";
Layout = "~/Views/Shared/_CommonLayout.cshtml";
}
<script type="text/javascript">
   $(document).keydown(function (event) {
       event = (event || window.event);
       if (event.keyCode == 13) {
           $('#btnSubmit').click();
       }
   });
   $(document).ready(function () {
       $('#path').html('Change Password');
       $('#btnReset').click(function () {
           Reset();
       });
       $('#btnSubmit').click(function () {
           if (validate()) {
               if (checkconfirm()) {
                   var ChamgePasswordParams = JSON.stringify({
                       ACTION: 'A',
                       UserID:@Session["UserID"],
                       UserName: '@Session["UserName"]',
                       Password: $('#Password').val(),
                       NewPassword: $('#NewPassword').val(),
                       ConfirmPassword: $('#ConfirmPassword').val()
                   });
                   $.ajax({
                       url: ServiceURL + "/api/Common/changePassword",
                       type: "POST",
                       data: ChamgePasswordParams,
                       dataType: "json",
                       contentType: "application/json; charset=utf-8",
                       success: function (data) {
                           // console.log(data);
                           if (data == '2') {
                               alert('Invalid Old Password!!');
                               $('#Password').focus();
                           }
                           else if (data == '1') {
                               alert('Password Change Sucessfully!!');
                               window.location.href = '@Url.Action("Login", "Dashboard")';
                           }
                       },
                       error: function (error) {
                           console.log(error.statusText);
                       }
                   });
               }
           }
       });
   });
   function Reset() {
       $('#Password').val('');
       $('#NewPassword').val('');
       $('#ConfirmPassword').val('');
   }
   function validate() {
       var regularExpression = /^(?=.*[0-9])(?=.*[!@@#$%^&*])[a-zA-Z0-9!@@#$%^&*]{6,16}$/;
       if ($('#Password').val() == "") {
           alert('Please Enter Old Password!!');
           $('#Password').focus();
           return false;
       }
       else if ($('#NewPassword').val() == "") {
           alert('Please Enter New Password!!');
           $('#NewPassword').focus();
           return false;
       }
       else if ($('#ConfirmPassword').val() == "") {
           alert('Please Enter Confirm Password!!');
           $('#NewPassword').focus();
           return false;
       }
       else if ($('#NewPassword').val().length < 8) {
           alert('Password must contain at least 8 character!');
          $('#NewPassword').focus();
           return false;
       }
       else  if (!$('#NewPassword').val().match(regularExpression))
             {
            alert('Password must contain at least one upparcase,lowercase,number and specialcharacter!!');
            $('#NewPassword').focus();
            return false;
       } 
       else if ($('#ConfirmPassword').val() != $('#NewPassword').val())
       {
           alert('Confirm Password Schould be same with New Password !!');
           $('#ConfirmPassword').focus();
           return false;
       }
       else {
           return true;
       }
   }
   function checkconfirm() {
       if (window.confirm("Are you sure to submit?")) {
           return true;
       }
       else {
           return false;
       }
   }
</script>



   <div class="container">
   @using (Html.BeginForm())
{
@Html.AntiForgeryToken()
         <div class="forgot-main">
            <div class="col-lg-4 col-md-12 col-sm-12 col-xs-12 wow fadeInLeft animated">
               <img src="~/imgs/passwod-bg.jpg" alt="">
            </div>
            <div class="col-lg-5 col-md-12 col-sm-12 col-xs-12 wow fadeInRight animated text-center">
                  <div class="panel panel-default">
                     <div class="row">
                        <div class="d-flex mb-4">
                           <div class="lock-circle mr-3"><i class="fi-rr-lock"></i></div>
                           <h2 class="text-left mb-0">
                           Forgot Password?
                           <div class="small-txt"> You can reset your password here. </div>
                           </h2>
                            
                         </div>
                    </div>
                              <div class="row mb-3 text-left">
                                 <div class="input-group mb-3">
                                    <label for="lblOldPwd" class="col-lg-12 col-form-label pt-0 pb-0 px-0 mb-2" id="oldPwd">Old Password <b><span style="color:red">*</span></b></label>
                                    <div class="input-group-prepend">  
                                       <span class="input-group-text" id="basic-addon1"><i class="fa fa-key"></i></span>
                                    </div>
                                    @Html.EditorFor(model => model.Password, new { htmlAttributes = new { @class = "form-control", autocomplete = "off", maxlength = "20", placeholder = "Enter Old Password", type = "password", @autofocus = "autofocus" } })
                                 </div>
                              </div>
                              <div class="row mb-3 text-left">
                                 <div class="input-group mb-3">
                                    <label for="lblPwd" class="col-lg-12 col-form-label pt-0 pb-0 px-0 mb-2" id="pwd">New Password <b><span style="color:red">*</span></b></label>
                                    <div class="input-group-prepend">  
                                       <span class="input-group-text" id="basic-addon1"><i class="fa fa-key"></i></span>
                                    </div>
                                    @Html.EditorFor(model => model.NewPassword, new { htmlAttributes = new { @class = "form-control", autocomplete = "off", maxlength = "20", placeholder = "Enter New Password", type = "password" } })
                                 </div>
                              </div>
                              <div class="row mb-3 text-left">
                                 <div class="input-group">
                                    <label for="lblConPwd" class="col-lg-12 col-form-label pt-0 pb-0 px-0 mb-2" id="ConPwd">Confirm Password <b><span style="color:red">*</span></b></label>
                                    <div class="input-group-prepend">  
                                       <span class="input-group-text" id="basic-addon1"><i class="fa fa-key"></i></span>
                                    </div>
                                    @Html.EditorFor(model => model.ConfirmPassword, new { htmlAttributes = new { @class = "form-control", autocomplete = "off", maxlength = "20", placeholder = "Enter Confirm Password", type = "password" } })
                                    <div class="col-md-12 pt-0 pb-0 px-0 mt-2">
                                       <small class="form-text text-muted">(New Password must contain at least 8 character,one upparcase,lowercase,number and specialcharacter.)</small>
                                    </div>
                                 </div>
                              </div>
                              <div class="row form-group mb-0">
                                 <div class="text-left">
                                    <input type="button" value="Submit" class="btn btn-success" id="btnSubmit" />
                                    <input type="button" value="Reset" class="btn btn-danger" id="btnReset" />
                                 </div>
                              </div>
                       
                     </div>
            </div>
         </div>
         }
		 </div>
         


